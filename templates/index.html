<!DOCTYPE html>
<html>
<head>
    <title>Homepage</title>
</head>
<body>
    <div id="buttonContainer">
        <!-- 여기에 버튼이 추가될 것입니다. -->
    </div>

    <script>
        // 서버에서 버튼 목록을 가져와서 페이지를 업데이트하는 함수
        async function updateButtons() {
            const response = await fetch("/", { method: "GET" });
            const buttonsData = await response.json();

            const buttonContainer = document.getElementById("buttonContainer");
            // 버튼 목록을 모두 삭제한 후 서버에서 받은 버튼 목록으로 재생성
            buttonContainer.innerHTML = "";
            buttonsData.forEach(button => {
                const newButton = document.createElement("button");
                newButton.textContent = "Hello, " + button.username + "!";
                buttonContainer.appendChild(newButton);
            });
        }

        // 페이지 로드 시 서버에서 버튼 목록을 가져와서 페이지를 업데이트함
        window.onload = updateButtons;

        // 외부에서 POST 요청을 보내어 버튼을 추가하는 함수
        async function addNewButton() {
            const username = prompt("Please enter your username:");
            if (username) {
                await fetch("/", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({ username: username })
                });
                await updateButtons();
            }
        }
    </script>

    <!-- 버튼 추가를 위한 버튼 -->
    <button onclick="addNewButton()">Add Button</button>
</body>
</html>
